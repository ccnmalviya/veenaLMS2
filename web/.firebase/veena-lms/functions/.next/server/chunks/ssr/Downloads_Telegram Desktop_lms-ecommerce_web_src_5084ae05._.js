module.exports=[29010,a=>{"use strict";async function b(a){if(!a||!a.includes("s3")&&!a.includes("amazonaws.com"))return a;try{let b=await fetch(`/api/s3-signed-url?key=${encodeURIComponent(a)}`);if(!b.ok){let c=await b.text();return console.error("Failed to get signed URL:",{status:b.status,statusText:b.statusText,error:c,imageUrl:a}),a}let c=await b.json();if(c.error)return console.error("Signed URL API error:",c.error),a;return c.url||a}catch(b){return console.error("Error getting signed URL:",b),a}}a.s(["getSignedImageUrl",()=>b])},18295,a=>{"use strict";var b=a.i(88398),c=a.i(96600),d=a.i(29010);function e({src:a,alt:e,className:f="",fallback:g}){let[h,i]=(0,c.useState)(a),[j,k]=(0,c.useState)(!0),[l,m]=(0,c.useState)(!1),[n,o]=(0,c.useState)("");return((0,c.useEffect)(()=>{if(!a||""===a.trim()){m(!0),k(!1);return}a.includes("s3")||a.includes("amazonaws.com")?(0,d.getSignedImageUrl)(a).then(a=>{i(a),k(!1)}).catch(b=>{i(a),k(!1)}):(i(a),k(!1))},[a]),l)?(0,b.jsx)("div",{className:f,children:g||(0,b.jsx)("div",{className:"w-full h-full flex items-center justify-center text-gray-400 bg-gray-100",children:(0,b.jsx)("svg",{className:"w-16 h-16",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})})}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("img",{src:h,alt:e,className:f,onError:a=>{m(!0),o("Failed to load image")},onLoad:()=>{k(!1),m(!1)},style:{opacity:j?.5:1}}),l&&!1]})}a.s(["S3Image",()=>e])},43068,a=>{"use strict";var b=a.i(88398),c=a.i(96600),d=a.i(71852);a.i(55614);var e=a.i(93749),f=a.i(47073),g=a.i(56219),h=a.i(35538),i=a.i(18295);function j(){let a=(0,d.useRouter)(),j=(0,d.useParams)(),k=j?.id,[l,m]=(0,c.useState)(!0),[n,o]=(0,c.useState)(!1),[p,q]=(0,c.useState)({name:"",slug:"",image:"",description:"",orderIndex:0,status:"active"});(0,c.useEffect)(()=>{k&&r()},[k]);let r=async()=>{try{m(!0);let b=(0,e.doc)(f.db,"categories",k),c=await (0,e.getDoc)(b);if(!c.exists()){alert("Category not found"),a.push("/admin/courses/categories");return}let d=c.data();q({name:d.name||"",slug:d.slug||"",image:d.image||"",description:d.description||"",orderIndex:d.orderIndex||0,status:d.status||"active"})}catch(a){console.error("Error loading category:",a),alert("Failed to load category")}finally{m(!1)}},s=a=>a.toLowerCase().trim().replace(/[^\w\s-]/g,"").replace(/[\s_-]+/g,"-").replace(/^-+|-+$/g,""),t=async b=>{b.preventDefault();try{o(!0);let b=(0,e.doc)(f.db,"categories",k);await (0,e.updateDoc)(b,{name:p.name,slug:p.slug||s(p.name),image:p.image||null,description:p.description||null,orderIndex:p.orderIndex,status:p.status,updatedAt:(0,e.serverTimestamp)()}),a.push("/admin/courses/categories")}catch(a){console.error("Error updating category:",a),alert("Failed to update category")}finally{o(!1)}};return l?(0,b.jsx)(g.AdminLayout,{children:(0,b.jsx)("div",{className:"text-center py-12",children:"Loading category..."})}):(0,b.jsx)(g.AdminLayout,{children:(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"mb-8",children:[(0,b.jsx)("button",{onClick:()=>a.back(),className:"text-blue-600 hover:text-blue-800 mb-4",children:"â† Back to Categories"}),(0,b.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Edit Course Category"}),(0,b.jsx)("p",{className:"text-gray-600 mt-2",children:"Update category details"})]}),(0,b.jsxs)("form",{onSubmit:t,className:"bg-white rounded-lg shadow p-6 space-y-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category Name *"}),(0,b.jsx)("input",{type:"text",required:!0,value:p.name,onChange:a=>{q({...p,name:a.target.value}),p.slug||q(b=>({...b,slug:s(a.target.value)}))},className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"e.g., Programming, Design, Marketing"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Slug *"}),(0,b.jsx)("input",{type:"text",required:!0,value:p.slug,onChange:a=>q({...p,slug:s(a.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"e.g., programming, design, marketing"}),(0,b.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Auto-generated from name, but can be edited"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Image (Optional)"}),p.image&&(0,b.jsx)("div",{className:"mb-4",children:(0,b.jsx)(i.S3Image,{src:p.image,alt:"Current category image",className:"w-32 h-32 object-cover border border-gray-300 rounded mb-2"})}),(0,b.jsx)(h.FileUpload,{accept:"image/*",folder:"categories/images",currentValue:p.image,onUploadComplete:a=>{q(b=>({...b,image:a}))},onUploadError:a=>{alert(`Upload failed: ${a}`)}}),p.image&&(0,b.jsx)("button",{type:"button",onClick:()=>q(a=>({...a,image:""})),className:"mt-2 text-sm text-red-600 hover:text-red-800",children:"Remove Image"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),(0,b.jsx)("textarea",{value:p.description,onChange:a=>q({...p,description:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",rows:3,placeholder:"Brief description of this category"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Order Index"}),(0,b.jsx)("input",{type:"number",value:p.orderIndex,onChange:a=>q({...p,orderIndex:parseInt(a.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"0"}),(0,b.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Lower numbers appear first in the category list"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),(0,b.jsxs)("select",{value:p.status,onChange:a=>q({...p,status:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:[(0,b.jsx)("option",{value:"active",children:"Active"}),(0,b.jsx)("option",{value:"inactive",children:"Inactive"})]})]}),(0,b.jsxs)("div",{className:"flex gap-4 pt-4",children:[(0,b.jsx)("button",{type:"submit",disabled:n,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:n?"Saving...":"Save Changes"}),(0,b.jsx)("button",{type:"button",onClick:()=>a.back(),className:"px-6 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300",children:"Cancel"})]})]})]})})}a.s(["default",()=>j])}];

//# sourceMappingURL=Downloads_Telegram%20Desktop_lms-ecommerce_web_src_5084ae05._.js.map