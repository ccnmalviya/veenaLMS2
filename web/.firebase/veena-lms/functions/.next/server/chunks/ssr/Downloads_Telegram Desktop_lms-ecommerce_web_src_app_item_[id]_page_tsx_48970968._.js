module.exports=[63207,a=>{"use strict";var b=a.i(88398),c=a.i(96600),d=a.i(71852),e=a.i(96884);a.i(55614);var f=a.i(93749),g=a.i(47073),h=a.i(86685),i=a.i(39218),j=a.i(61050),k=a.i(89113),l=a.i(18295);function m(){let a=(0,d.useParams)(),m=(0,d.useRouter)(),n=a?.id,[o,p]=(0,c.useState)(null),[q,r]=(0,c.useState)(!0),[s,t]=(0,c.useState)(0),[u,v]=(0,c.useState)([]),[w,x]=(0,c.useState)({}),[y,z]=(0,c.useState)(!1),[A,B]=(0,c.useState)(!1),[C,D]=(0,c.useState)(!1);(0,c.useEffect)(()=>{if(!n){console.error("No product ID provided"),r(!1);return}E()},[n]);let E=async()=>{try{if(r(!0),console.log("Loading product with ID:",n),!n||""===n.trim()){console.error("Invalid product ID:",n),p(null),r(!1);return}let a=null;try{let b=(0,f.doc)(g.db,"store_items",n),c=await (0,f.getDoc)(b);c.exists()&&(a=c,console.log("Product found by document ID"))}catch(a){console.log("Product not found by document ID, trying itemId field")}if(!a)try{let b=(0,f.query)((0,f.collection)(g.db,"store_items"),(0,f.where)("itemId","==",n)),c=await (0,f.getDocs)(b);c.empty||(a=c.docs[0],console.log("Product found by itemId field"))}catch(a){console.error("Error searching by itemId field:",a)}if(!a)try{let b=(0,f.query)((0,f.collection)(g.db,"store_items"),(0,f.where)("item_id","==",n)),c=await (0,f.getDocs)(b);c.empty||(a=c.docs[0],console.log("Product found by item_id field"))}catch(a){console.error("Error searching by item_id field:",a)}if(!a||!a.exists()){console.error("Product not found in Firestore:",{productId:n,collection:"store_items",searchedBy:["document ID","itemId field","item_id field"]}),p(null),r(!1);return}let b=a.data();console.log("Product data loaded:",b),console.log("Firestore document ID:",a.id);let c=[];b.images?c=Array.isArray(b.images)?b.images:[b.images]:b.image&&(c=Array.isArray(b.image)?b.image:[b.image]);let d=b.basePrice||b.price||0,e=b.compareAtPrice||b.compare_at_price||b.discount_price||null,h={itemId:a.id,...b,images:c,basePrice:d,compareAtPrice:e};p(h),h.categoryId&&I(h.categoryId,h.itemId)}catch(a){console.error("Error loading product:",a),p(null)}finally{r(!1)}},F=async()=>{if(!o||o.trackInventory&&0===o.stockQuantity)return;let a=g.auth.currentUser;if(!a)return void m.push(`/login?redirect=/item/${o.itemId}`);try{z(!0),await (0,f.addDoc)((0,f.collection)(g.db,"carts"),{userId:a.uid,itemId:o.itemId,quantity:1,addedAt:(0,f.serverTimestamp)(),title:o.title,price:o.basePrice,image:o.images?.[0]||null,type:o.itemType||o.type||"product"}),alert("Added to cart.")}catch(a){console.error("Failed to add to cart:",a),alert("Failed to add to cart. Please try again.")}finally{z(!1)}},G=async()=>{if(!o||o.trackInventory&&0===o.stockQuantity)return;let a=g.auth.currentUser;if(!a)return void m.push(`/login?redirect=/item/${o.itemId}`);try{B(!0),await (0,f.addDoc)((0,f.collection)(g.db,"carts"),{userId:a.uid,itemId:o.itemId,quantity:1,addedAt:(0,f.serverTimestamp)(),title:o.title,price:o.basePrice,image:o.images?.[0]||null,type:o.itemType||o.type||"product",source:"buy_now"}),m.push("/cart")}catch(a){console.error("Failed to start checkout:",a),alert("Failed to start checkout. Please try again.")}finally{B(!1)}},H=async()=>{if(!o)return;let a=g.auth.currentUser;if(!a)return void m.push(`/login?redirect=/item/${o.itemId}`);try{D(!0),await (0,f.addDoc)((0,f.collection)(g.db,"wishlists"),{userId:a.uid,itemId:o.itemId,type:"product",createdAt:(0,f.serverTimestamp)()}),alert("Product added to your wishlist.")}catch(a){console.error("Failed to add to wishlist:",a),alert("Failed to add to wishlist. Please try again.")}finally{D(!1)}},I=async(a,b)=>{try{let c=await (0,f.getDocs)((0,f.collection)(g.db,"store_items")),d=[],e={};c.forEach(c=>{let f=c.data();if(c.id!==b&&f.categoryId===a&&(!f.status||"active"===f.status)){let a=[];f.images?a=Array.isArray(f.images)?f.images:[f.images]:f.image&&(a=Array.isArray(f.image)?f.image:[f.image]);let b={itemId:c.id,...f,images:a,basePrice:f.basePrice||f.price||0,compareAtPrice:f.compareAtPrice||f.compare_at_price||f.discount_price||null};d.push(b),a.length>0&&(e[b.itemId]=a[0])}}),d.sort((a,b)=>{let c=a.createdAt?.toMillis?.()||0;return(b.createdAt?.toMillis?.()||0)-c});let h=d.slice(0,4);v(h),x(e)}catch(a){console.error("Error loading recommended products:",a)}};if(q)return(0,b.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,b.jsx)(h.Header,{}),(0,b.jsx)(k.NotificationStrip,{}),(0,b.jsx)(j.CategoryNavigation,{}),(0,b.jsx)("div",{className:"container mx-auto px-4 py-20",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,b.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading product..."})]})}),(0,b.jsx)(i.Footer,{})]});if(!o)return(0,b.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,b.jsx)(h.Header,{}),(0,b.jsx)(k.NotificationStrip,{}),(0,b.jsx)(j.CategoryNavigation,{}),(0,b.jsx)("div",{className:"container mx-auto px-4 py-20",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("h1",{className:"text-4xl font-bold text-gray-900 mb-4",children:"Product Not Found"}),(0,b.jsx)("p",{className:"text-gray-600 mb-2",children:"The product you're looking for doesn't exist."}),n&&(0,b.jsxs)("p",{className:"text-sm text-gray-500 mb-8",children:["Product ID: ",(0,b.jsx)("code",{className:"bg-gray-200 px-2 py-1 rounded",children:n})]}),(0,b.jsxs)("div",{className:"flex gap-4 justify-center",children:[(0,b.jsx)(e.default,{href:"/",className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Go Back Home"}),(0,b.jsx)("button",{onClick:()=>m.back(),className:"px-6 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors",children:"Go Back"})]})]})}),(0,b.jsx)(i.Footer,{})]});let J=o.images||[],K=J[s]||J[0]||"";return(0,b.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,b.jsx)(h.Header,{}),(0,b.jsx)(k.NotificationStrip,{}),(0,b.jsx)(j.CategoryNavigation,{}),(0,b.jsxs)("main",{className:"container mx-auto px-4 py-8",children:[(0,b.jsx)("nav",{className:"mb-6 text-sm",children:(0,b.jsxs)("ol",{className:"flex items-center space-x-2 text-gray-600",children:[(0,b.jsx)("li",{children:(0,b.jsx)(e.default,{href:"/",className:"hover:text-blue-600",children:"Home"})}),(0,b.jsx)("li",{children:"/"}),(0,b.jsx)("li",{children:(0,b.jsx)(e.default,{href:"/",className:"hover:text-blue-600",children:"Products"})}),(0,b.jsx)("li",{children:"/"}),(0,b.jsx)("li",{className:"text-gray-900",children:o.title})]})}),(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 bg-white rounded-lg shadow-lg p-6",children:[(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)("div",{className:"aspect-square bg-gray-100 rounded-lg overflow-hidden",children:K?(0,b.jsx)(l.S3Image,{src:K,alt:o.title,className:"w-full h-full object-cover"}):(0,b.jsx)("div",{className:"w-full h-full flex items-center justify-center text-gray-400",children:(0,b.jsx)("svg",{className:"w-24 h-24",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})})}),J.length>1&&(0,b.jsx)("div",{className:"grid grid-cols-4 gap-2",children:J.map((a,c)=>(0,b.jsx)("button",{onClick:()=>t(c),className:`aspect-square rounded-lg overflow-hidden border-2 transition-all ${s===c?"border-blue-600 ring-2 ring-blue-200":"border-gray-200 hover:border-gray-300"}`,children:(0,b.jsx)(l.S3Image,{src:a,alt:`${o.title} ${c+1}`,className:"w-full h-full object-cover"})},c))})]}),(0,b.jsxs)("div",{className:"space-y-6",children:[o.itemType&&(0,b.jsx)("span",{className:"inline-block bg-blue-600 text-white text-xs px-3 py-1 rounded-full uppercase font-semibold",children:o.itemType.replace("_"," ")}),(0,b.jsx)("h1",{className:"text-3xl md:text-4xl font-bold text-gray-900",children:o.title}),(0,b.jsxs)("div",{className:"space-y-2 py-4 border-y border-gray-200",children:[o.compareAtPrice&&o.compareAtPrice>o.basePrice&&(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsxs)("span",{className:"text-2xl text-gray-500 line-through",children:["₹",o.compareAtPrice.toLocaleString()]}),(0,b.jsxs)("span",{className:"text-sm bg-red-100 text-red-600 font-semibold px-2 py-1 rounded",children:[Math.round((o.compareAtPrice-o.basePrice)/o.compareAtPrice*100),"% OFF"]})]}),(0,b.jsxs)("div",{className:"text-4xl font-bold text-blue-600",children:["₹",o.basePrice.toLocaleString()]})]}),o.shortDescription&&(0,b.jsx)("p",{className:"text-lg text-gray-600",children:o.shortDescription}),o.trackInventory&&void 0!==o.stockQuantity&&(0,b.jsx)("div",{className:"flex items-center gap-2",children:o.stockQuantity>0?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("span",{className:"w-3 h-3 bg-green-500 rounded-full"}),(0,b.jsxs)("span",{className:"text-green-600 font-semibold",children:[o.stockQuantity," in stock"]})]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("span",{className:"w-3 h-3 bg-red-500 rounded-full"}),(0,b.jsx)("span",{className:"text-red-600 font-semibold",children:"Out of stock"})]})}),(0,b.jsxs)("div",{className:"space-y-3 pt-4",children:[(0,b.jsxs)("div",{className:"flex gap-3",children:[(0,b.jsx)("button",{type:"button",onClick:F,disabled:y||o.trackInventory&&0===o.stockQuantity,className:`flex-1 py-4 px-6 rounded-lg font-semibold text-lg transition-colors ${o.trackInventory&&0===o.stockQuantity?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"}`,children:o.trackInventory&&0===o.stockQuantity?"Out of Stock":y?"Adding...":"Add to Cart"}),(0,b.jsx)("button",{type:"button",onClick:H,className:"px-4 py-4 rounded-lg border-2 border-gray-300 hover:border-gray-400 transition-colors",title:"Add to Wishlist",disabled:C,children:(0,b.jsx)("svg",{className:"w-6 h-6 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})})})]}),(0,b.jsx)("button",{type:"button",onClick:G,disabled:A||o.trackInventory&&0===o.stockQuantity,className:"w-full py-4 px-6 rounded-lg font-semibold text-lg border-2 border-blue-600 text-blue-600 hover:bg-blue-50 transition-colors disabled:opacity-60 disabled:cursor-not-allowed",children:o.trackInventory&&0===o.stockQuantity?"Out of Stock":A?"Processing...":"Buy Now"})]}),o.fullDescription&&(0,b.jsxs)("div",{className:"pt-6 border-t",children:[(0,b.jsx)("h2",{className:"text-xl font-bold text-gray-900 mb-3",children:"Description"}),(0,b.jsx)("div",{className:"text-gray-700 whitespace-pre-wrap leading-relaxed",children:o.fullDescription})]}),(o.material||o.dimensions||o.warranty)&&(0,b.jsxs)("div",{className:"pt-6 border-t space-y-2",children:[o.material&&(0,b.jsxs)("div",{className:"flex",children:[(0,b.jsx)("span",{className:"font-semibold text-gray-700 w-32",children:"Material:"}),(0,b.jsx)("span",{className:"text-gray-600",children:o.material})]}),o.dimensions&&(0,b.jsxs)("div",{className:"flex",children:[(0,b.jsx)("span",{className:"font-semibold text-gray-700 w-32",children:"Dimensions:"}),(0,b.jsx)("span",{className:"text-gray-600",children:o.dimensions})]}),o.warranty&&(0,b.jsxs)("div",{className:"flex",children:[(0,b.jsx)("span",{className:"font-semibold text-gray-700 w-32",children:"Warranty:"}),(0,b.jsx)("span",{className:"text-gray-600",children:o.warranty})]})]})]})]}),u.length>0&&(0,b.jsxs)("section",{className:"mt-12",children:[(0,b.jsx)("h2",{className:"text-2xl md:text-3xl font-bold text-gray-900 mb-6",children:"Recommended for You"}),(0,b.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6",children:u.map(a=>(0,b.jsxs)(e.default,{href:`/item/${a.itemId}`,className:"bg-white rounded-lg shadow-md overflow-hidden hover:shadow-lg transition-shadow",children:[(0,b.jsx)("div",{className:"aspect-square bg-gray-200 relative overflow-hidden",children:w[a.itemId]?(0,b.jsx)(l.S3Image,{src:w[a.itemId],alt:a.title,className:"w-full h-full object-cover"}):(0,b.jsx)("div",{className:"w-full h-full flex items-center justify-center text-gray-400",children:(0,b.jsx)("svg",{className:"w-16 h-16",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})})}),(0,b.jsxs)("div",{className:"p-4",children:[(0,b.jsx)("h3",{className:"font-semibold text-lg text-gray-900 mb-2 line-clamp-2",children:a.title}),a.shortDescription&&(0,b.jsx)("p",{className:"text-sm text-gray-600 mb-3 line-clamp-2",children:a.shortDescription}),(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[a.compareAtPrice&&a.compareAtPrice>a.basePrice&&(0,b.jsxs)("span",{className:"text-sm text-gray-500 line-through mr-2",children:["₹",a.compareAtPrice.toLocaleString()]}),(0,b.jsxs)("span",{className:"text-xl font-bold text-blue-600",children:["₹",a.basePrice.toLocaleString()]})]})]})]},a.itemId))})]})]}),(0,b.jsx)(i.Footer,{})]})}a.s(["default",()=>m])}];

//# sourceMappingURL=Downloads_Telegram%20Desktop_lms-ecommerce_web_src_app_item_%5Bid%5D_page_tsx_48970968._.js.map