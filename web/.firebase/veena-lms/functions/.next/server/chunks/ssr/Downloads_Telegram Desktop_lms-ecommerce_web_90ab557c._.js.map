{"version":3,"sources":["../../../../../../../../Downloads/Telegram%20Desktop/lms-ecommerce/web/src/lib/s3ImageHelper.ts","../../../../../../../../Downloads/Telegram%20Desktop/lms-ecommerce/web/src/components/common/S3Image.tsx","../../../../../../../../Downloads/Telegram%20Desktop/lms-ecommerce/web/node_modules/lucide-react/src/icons/plus.ts","../../../../../../../../Downloads/Telegram%20Desktop/lms-ecommerce/web/node_modules/lucide-react/src/icons/trash-2.ts","../../../../../../../../Downloads/Telegram%20Desktop/lms-ecommerce/web/node_modules/lucide-react/src/icons/pen.ts"],"sourcesContent":["/**\n * Helper function to get signed S3 URLs for images\n * This is needed because S3 objects with KMS encryption require signed URLs\n */\n\nexport async function getSignedImageUrl(imageUrl: string): Promise<string> {\n  // If it's not an S3 URL, return as-is\n  if (!imageUrl || (!imageUrl.includes(\"s3\") && !imageUrl.includes(\"amazonaws.com\"))) {\n    return imageUrl;\n  }\n\n  try {\n    // Pass the full URL as-is; the API will extract the S3 object key\n    const response = await fetch(`/api/s3-signed-url?key=${encodeURIComponent(imageUrl)}`);\n    \n    if (!response.ok) {\n      const errorText = await response.text();\n      console.error(\"Failed to get signed URL:\", {\n        status: response.status,\n        statusText: response.statusText,\n        error: errorText,\n        imageUrl: imageUrl\n      });\n      return imageUrl; // Fallback to original URL\n    }\n\n    const data = await response.json();\n    if (data.error) {\n      console.error(\"Signed URL API error:\", data.error);\n      return imageUrl; // Fallback to original URL\n    }\n    return data.url || imageUrl;\n  } catch (error) {\n    console.error(\"Error getting signed URL:\", error);\n    return imageUrl; // Fallback to original URL\n  }\n}\n\n/**\n * Get signed URLs for multiple images\n */\nexport async function getSignedImageUrls(imageUrls: string[]): Promise<string[]> {\n  return Promise.all(imageUrls.map(url => getSignedImageUrl(url)));\n}\n\n","\"use client\";\n\nimport { useState, useEffect } from \"react\";\nimport { getSignedImageUrl } from \"@/lib/s3ImageHelper\";\n\ninterface S3ImageProps {\n  src: string;\n  alt: string;\n  className?: string;\n  fallback?: React.ReactNode;\n}\n\nexport function S3Image({ src, alt, className = \"\", fallback }: S3ImageProps) {\n  const [imageUrl, setImageUrl] = useState<string>(src);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(false);\n  const [errorMessage, setErrorMessage] = useState<string>(\"\");\n\n  useEffect(() => {\n    // Handle empty or invalid src\n    if (!src || src.trim() === \"\") {\n      setError(true);\n      setLoading(false);\n      return;\n    }\n\n    // Only get signed URL if it's an S3 URL\n    if (src.includes(\"s3\") || src.includes(\"amazonaws.com\")) {\n      getSignedImageUrl(src)\n        .then((signedUrl) => {\n          setImageUrl(signedUrl);\n          setLoading(false);\n        })\n        .catch((err) => {\n          // Fallback to original URL - might work if bucket has public read access\n          setImageUrl(src);\n          setLoading(false);\n        });\n    } else {\n      // Not an S3 URL, use as-is\n      setImageUrl(src);\n      setLoading(false);\n    }\n  }, [src]);\n\n  if (error) {\n    return (\n      <div className={className}>\n        {fallback || (\n          <div className=\"w-full h-full flex items-center justify-center text-gray-400 bg-gray-100\">\n            <svg className=\"w-16 h-16\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z\" />\n            </svg>\n          </div>\n        )}\n      </div>\n    );\n  }\n\n  return (\n    <>\n      <img\n        src={imageUrl}\n        alt={alt}\n        className={className}\n        onError={(e) => {\n          // Silently handle image load errors - don't spam console\n          if (process.env.NODE_ENV === \"development\") {\n            console.warn(\"S3Image: Image failed to load\", imageUrl);\n          }\n          setError(true);\n          setErrorMessage(\"Failed to load image\");\n        }}\n        onLoad={() => {\n          setLoading(false);\n          setError(false);\n        }}\n        style={{ opacity: loading ? 0.5 : 1 }}\n      />\n      {error && process.env.NODE_ENV === \"development\" && (\n        <div className=\"text-xs text-red-500 mt-1\">\n          Image load failed. Check console for details.\n        </div>\n      )}\n    </>\n  );\n}\n\n\n\n","import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  ['path', { d: 'M5 12h14', key: '1ays0h' }],\n  ['path', { d: 'M12 5v14', key: 's699le' }],\n];\n\n/**\n * @component @name Plus\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNNSAxMmgxNCIgLz4KICA8cGF0aCBkPSJNMTIgNXYxNCIgLz4KPC9zdmc+Cg==) - https://lucide.dev/icons/plus\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Plus = createLucideIcon('plus', __iconNode);\n\nexport default Plus;\n","import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  ['path', { d: 'M10 11v6', key: 'nco0om' }],\n  ['path', { d: 'M14 11v6', key: 'outv1u' }],\n  ['path', { d: 'M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6', key: 'miytrc' }],\n  ['path', { d: 'M3 6h18', key: 'd0wm0j' }],\n  ['path', { d: 'M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2', key: 'e791ji' }],\n];\n\n/**\n * @component @name Trash2\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMTAgMTF2NiIgLz4KICA8cGF0aCBkPSJNMTQgMTF2NiIgLz4KICA8cGF0aCBkPSJNMTkgNnYxNGEyIDIgMCAwIDEtMiAySDdhMiAyIDAgMCAxLTItMlY2IiAvPgogIDxwYXRoIGQ9Ik0zIDZoMTgiIC8+CiAgPHBhdGggZD0iTTggNlY0YTIgMiAwIDAgMSAyLTJoNGEyIDIgMCAwIDEgMiAydjIiIC8+Cjwvc3ZnPgo=) - https://lucide.dev/icons/trash-2\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Trash2 = createLucideIcon('trash-2', __iconNode);\n\nexport default Trash2;\n","import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  [\n    'path',\n    {\n      d: 'M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z',\n      key: '1a8usu',\n    },\n  ],\n];\n\n/**\n * @component @name Pen\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMjEuMTc0IDYuODEyYTEgMSAwIDAgMC0zLjk4Ni0zLjk4N0wzLjg0MiAxNi4xNzRhMiAyIDAgMCAwLS41LjgzbC0xLjMyMSA0LjM1MmEuNS41IDAgMCAwIC42MjMuNjIybDQuMzUzLTEuMzJhMiAyIDAgMCAwIC44My0uNDk3eiIgLz4KPC9zdmc+Cg==) - https://lucide.dev/icons/pen\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Pen = createLucideIcon('pen', __iconNode);\n\nexport default Pen;\n"],"names":[],"mappings":"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","ignoreList":[2,3,4]}