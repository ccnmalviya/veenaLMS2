module.exports=[96940,a=>{"use strict";var b=a.i(88398),c=a.i(96600),d=a.i(71852);a.i(55614);var e=a.i(93749),f=a.i(47073),g=a.i(56219),h=a.i(35538);function i(){let a=(0,d.useRouter)(),[i,j]=(0,c.useState)(!1),[k,l]=(0,c.useState)([]),[m,n]=(0,c.useState)({name:"",slug:"",parentCategoryId:"",image:"",description:"",orderIndex:0,status:"active"});(0,c.useEffect)(()=>{o()},[]);let o=async()=>{try{let a=(0,e.query)((0,e.collection)(f.db,"categories"),(0,e.where)("status","==","active")),b=await (0,e.getDocs)(a),c=[];b.forEach(a=>{c.push({categoryId:a.id,...a.data()})}),l(c)}catch(a){console.error("Error loading categories:",a)}},p=a=>a.toLowerCase().trim().replace(/[^\w\s-]/g,"").replace(/[\s_-]+/g,"-").replace(/^-+|-+$/g,""),q=async a=>{let b=(0,e.query)((0,e.collection)(f.db,"categories"),(0,e.where)("slug","==",a));return(await (0,e.getDocs)(b)).empty},r=async b=>{b.preventDefault();try{j(!0);let b=m.slug||p(m.name),c=1,d=b;for(;!await q(d);)d=`${b}-${c}`,c++;await (0,e.addDoc)((0,e.collection)(f.db,"categories"),{name:m.name,slug:d,parentCategoryId:m.parentCategoryId||null,image:m.image||null,description:m.description||null,orderIndex:m.orderIndex,status:m.status,createdAt:(0,e.serverTimestamp)(),updatedAt:(0,e.serverTimestamp)()}),a.push("/admin/store-items/categories")}catch(a){console.error("Error creating category:",a),alert("Failed to create category")}finally{j(!1)}};return(0,b.jsx)(g.AdminLayout,{children:(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"mb-8",children:[(0,b.jsx)("button",{onClick:()=>a.back(),className:"text-blue-600 hover:text-blue-800 mb-4",children:"â† Back"}),(0,b.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Add New Category"})]}),(0,b.jsx)("form",{onSubmit:r,className:"bg-white rounded-lg shadow p-6 max-w-2xl",children:(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name *"}),(0,b.jsx)("input",{type:"text",required:!0,value:m.name,onChange:a=>{n({...m,name:a.target.value,slug:p(a.target.value)})},className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"Category Name"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Slug *"}),(0,b.jsx)("input",{type:"text",required:!0,value:m.slug,onChange:a=>n({...m,slug:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"category-slug"}),(0,b.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Auto-generated from name, but can be edited"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Parent Category"}),(0,b.jsxs)("select",{value:m.parentCategoryId,onChange:a=>n({...m,parentCategoryId:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:[(0,b.jsx)("option",{value:"",children:"None (Top Level)"}),k.map(a=>(0,b.jsx)("option",{value:a.categoryId,children:a.name},a.categoryId))]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Image (Optional)"}),(0,b.jsx)(h.FileUpload,{accept:"image/*",folder:"categories/images",currentValue:m.image,onUploadComplete:a=>{console.log("Upload complete, URL:",a),n(b=>({...b,image:a}))},onUploadError:a=>{alert(`Upload failed: ${a}`)}}),m.image&&(0,b.jsxs)("div",{className:"mt-4",children:[(0,b.jsx)("img",{src:m.image,alt:"Category image",className:"w-32 h-32 object-cover border border-gray-300 rounded"}),(0,b.jsx)("button",{type:"button",onClick:()=>n(a=>({...a,image:""})),className:"mt-2 text-sm text-red-600 hover:text-red-800",children:"Remove Image"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description (Optional)"}),(0,b.jsx)("textarea",{rows:4,value:m.description,onChange:a=>n({...m,description:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"Category description..."})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Order Index"}),(0,b.jsx)("input",{type:"number",value:m.orderIndex,onChange:a=>n({...m,orderIndex:parseInt(a.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"0"}),(0,b.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Lower numbers appear first"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status *"}),(0,b.jsxs)("select",{required:!0,value:m.status,onChange:a=>n({...m,status:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:[(0,b.jsx)("option",{value:"active",children:"Active"}),(0,b.jsx)("option",{value:"inactive",children:"Inactive"})]})]}),(0,b.jsxs)("div",{className:"flex gap-4 pt-4",children:[(0,b.jsx)("button",{type:"submit",disabled:i,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:i?"Creating...":"Create Category"}),(0,b.jsx)("button",{type:"button",onClick:()=>a.back(),className:"px-6 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300",children:"Cancel"})]})]})})]})})}a.s(["default",()=>i])}];

//# sourceMappingURL=2f7c9_lms-ecommerce_web_src_app_admin_store-items_categories_new_page_tsx_f85836b4._.js.map